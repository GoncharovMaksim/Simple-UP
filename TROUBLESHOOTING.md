# Решение проблем с Docker

## Проблема: localhost:8080 недоступен

### Шаг 1: Диагностика

Запустите скрипт диагностики:
```bash
check-docker.bat
```

Или проверьте вручную:

#### Проверка контейнеров:
```bash
docker-compose ps
```

Все контейнеры должны быть в статусе `Up`.

#### Проверка логов:
```bash
docker-compose logs wordpress --tail=50
```

#### Проверка порта:
```bash
netstat -an | findstr ":8080"
```

### Шаг 2: Возможные решения

#### Решение 1: Подождите немного

После запуска Docker контейнерам нужно время для инициализации (30-60 секунд).

1. Подождите 1-2 минуты
2. Обновите страницу в браузере (F5 или Ctrl+F5)
3. Попробуйте открыть: http://127.0.0.1:8080

#### Решение 2: Порт 8080 занят

Если порт 8080 уже используется другим приложением:

1. **Измените порт в docker-compose.yml:**
   ```yaml
   ports:
     - "8082:80"  # Используйте другой порт
   ```

2. **Или найдите и остановите программу, использующую порт 8080:**
   ```bash
   netstat -ano | findstr ":8080"
   taskkill /PID <PID> /F
   ```

3. Перезапустите контейнеры:
   ```bash
   docker-compose down
   docker-compose up -d
   ```

#### Решение 3: Проблема с браузером

1. **Очистите кеш браузера:**
   - Нажмите Ctrl+Shift+Delete
   - Выберите "Кэшированные изображения и файлы"
   - Нажмите "Очистить данные"

2. **Попробуйте другой браузер:**
   - Chrome
   - Firefox
   - Edge

3. **Попробуйте другой адрес:**
   - http://127.0.0.1:8080
   - http://localhost:8080
   - http://0.0.0.0:8080

4. **Откройте в режиме инкогнито:**
   - Chrome: Ctrl+Shift+N
   - Firefox: Ctrl+Shift+P

#### Решение 4: Firewall блокирует подключение

1. **Проверьте настройки Firewall Windows:**
   - Откройте "Брандмауэр Защитника Windows"
   - Проверьте, разрешено ли подключение к порту 8080

2. **Временно отключите Firewall для проверки:**
   - (Не рекомендуется для постоянного использования)

#### Решение 5: Полный перезапуск

Если ничего не помогло, полностью перезапустите проект:

```bash
# Остановить и удалить контейнеры
docker-compose down

# Удалить volumes (ОСТОРОЖНО: это удалит базу данных!)
docker-compose down -v

# Запустить заново
docker-compose up -d

# Подождать 1-2 минуты
# Открыть http://localhost:8080
```

#### Решение 6: Проблема с правами доступа

На Windows это редко, но может быть проблема с правами на папку `wordpress`:

1. Убедитесь, что папка `wordpress` существует
2. Проверьте права доступа к папке
3. Если нужно, удалите папку `wordpress` и перезапустите:
   ```bash
   docker-compose down
   rmdir /s /q wordpress
   docker-compose up -d
   ```

### Шаг 3: Проверка через командную строку

Проверьте, действительно ли WordPress отвечает:

```bash
# Проверка из контейнера
docker-compose exec wordpress curl -I http://localhost

# Проверка с хоста (если установлен curl)
curl -I http://localhost:8080

# Или используйте PowerShell
Invoke-WebRequest -Uri http://localhost:8080 -Method Head
```

Если вы видите ответ `HTTP/1.1 302 Found` или `HTTP/1.1 200 OK`, значит WordPress работает, и проблема в браузере или сети.

### Шаг 4: Проверка логов WordPress

Просмотрите последние логи:

```bash
docker-compose logs wordpress --tail=50 -f
```

Ищите ошибки, связанные с:
- Подключением к базе данных
- Правами доступа к файлам
- Конфигурацией WordPress

### Шаг 5: Проверка базы данных

Убедитесь, что база данных работает:

```bash
# Проверка подключения к БД
docker-compose exec db mysql -u wordpress -pwordpress -e "SELECT 1;" wordpress

# Просмотр логов БД
docker-compose logs db --tail=20
```

## Другие распространенные проблемы

### Проблема: Контейнеры не запускаются

**Решение:**
1. Проверьте, что Docker Desktop запущен
2. Проверьте логи: `docker-compose logs`
3. Убедитесь, что порты не заняты
4. Попробуйте перезапустить Docker Desktop

### Проблема: Тема не видна в WordPress

**Решение:**
1. Убедитесь, что папка `wordpress-theme` существует
2. Проверьте, что тема подключена в `docker-compose.yml`
3. Перезапустите контейнеры:
   ```bash
   docker-compose restart wordpress
   ```
4. Проверьте права доступа к папке темы

### Проблема: Ошибка подключения к базе данных

**Решение:**
1. Убедитесь, что контейнер `db` запущен
2. Подождите 30-60 секунд после запуска (БД нужно время для инициализации)
3. Проверьте переменные окружения в `docker-compose.yml`
4. Перезапустите контейнеры:
   ```bash
   docker-compose restart
   ```

### Проблема: Изменения в теме не применяются

**Решение:**
1. Убедитесь, что файлы темы изменились
2. Очистите кеш браузера (Ctrl+Shift+Delete)
3. Перезагрузите страницу (Ctrl+F5)
4. Проверьте, что тема активирована в WordPress

## Полезные команды

```bash
# Просмотр статуса контейнеров
docker-compose ps

# Просмотр логов
docker-compose logs -f

# Перезапуск контейнеров
docker-compose restart

# Остановка контейнеров
docker-compose down

# Запуск контейнеров
docker-compose up -d

# Войти в контейнер WordPress
docker-compose exec wordpress bash

# Войти в контейнер MySQL
docker-compose exec db mysql -u wordpress -pwordpress wordpress

# Просмотр использования ресурсов
docker stats
```

## Получение помощи

Если проблема не решена:

1. Запустите `check-docker.bat` для диагностики
2. Сохраните вывод логов:
   ```bash
   docker-compose logs > logs.txt
   ```
3. Проверьте документацию Docker: https://docs.docker.com/
4. Проверьте документацию WordPress: https://wordpress.org/support/

## Контрольный список

- [ ] Docker Desktop запущен
- [ ] Контейнеры запущены (`docker-compose ps`)
- [ ] Порт 8080 свободен
- [ ] Прошло 1-2 минуты после запуска
- [ ] Браузер обновлен (Ctrl+F5)
- [ ] Попробованы разные адреса (localhost, 127.0.0.1)
- [ ] Попробован другой браузер
- [ ] Firewall не блокирует порт
- [ ] Логи не показывают ошибок

Если все пункты выполнены, но проблема остается, попробуйте полный перезапуск с удалением volumes.

